
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Linux 操作系统安装盘的定制 - My Octopress Blog</title>
  <meta name="author" content="Your Name">

  
  <meta name="description" content="汪伦伟 （xc_wangwei@163.com） 国防科技大学博士研究生 2005 年 3 月 本文阐述如何以一个现有的 RedHat Linux系统安装盘为蓝本，定制符合需要的 Linux 系统安装盘。 1 引言 通常由于某种实际应用，需要一个包含所有最近更新的RPM包的操作系统发布盘， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://yoursite.com/old_post.before.2007/2005-04-07-linux.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="My Octopress Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">My Octopress Blog</a></h1>
  
    <h2>A blogging framework for hackers.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:yoursite.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
    <li><a href="/categories/gfrog-ride">骑行笔记</a></li>
    <li><a href="/categories/linux">Linux</a></li>
    <li><a href="/categories/picture">美丽图片</a></li>
    <li><a href="/categories/twitter-backup">Tweets</a></li>
    <li><a href="/blog/archives">全部日志</a></li>
    <li><a href="http://about.me/gfrog">关于我</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Linux 操作系统安装盘的定制</h1>
    
    
      <p class="meta">
        








  


<time datetime="2005-04-07T20:28:35+08:00" pubdate data-updated="true">Apr 7<span>th</span>, 2005</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>汪伦伟 （xc_wangwei@163.com）</p>

<p>国防科技大学博士研究生</p>

<p>2005 年 3 月</p>

<blockquote><p>本文阐述如何以一个现有的 RedHat Linux系统安装盘为蓝本，定制符合需要的 Linux   系统安装盘。</p></blockquote>

<p>1   引言</p>

<p>通常由于某种实际应用，需要一个包含所有最近更新的RPM包的操作系统发布盘，以备在安装时一次完成所有的更新操作，或者是想定制一个有自己特色的操作系统发布盘，如将自己开发的应用程序通过创建RPM包，加入到操作系统中，在系统安装时一次完成，形成包含自己产品的操作系统发布盘。这些都需要重新生成安装盘，而且生成安装盘也是十分必要的，因为操作系统发布商在每一次正式发布后，总会对一些漏洞进行更新处理，有些还是与安全相关的，在重新生成安装盘时就可以将这些bug修复添加进你自己定制的安装盘中，对一些设备新开发的驱动程序提供支持也需要重新生成安装盘。</p>

<p>在一些嵌入式具体应用中，由于其对操作系统的要求较具体，不需要当前操作系统安装盘中自带的那么多的功能，如Fedora Core   2当前有4张安装盘，它包含了许多其它的应用，如office、娱乐和游戏等等，而一些具体的应用根本不需要这么多的功能，因此，它们常常需要基于一个版本的操作系统，然后对之进行相应的裁减，使之能满足具体应用的实际需要，而不需要其它的多余的功能。因此，通过操作系统安装盘的定制，可以根据自己或实际的需要，选择有用的软件包，组成安装盘，从而通过定制操作系统的安装，满足具体应用的需要。</p>

<p>我们在定制操作系统安装盘之前，必须有一个蓝本作为安装盘的基础，比如是Red Hat 9.0安装盘或Fedora Core 2安装盘，也可以是Red Hat   9.0或Fedora Core 2安装盘的iso文件，这些我们可以从Red Hat的网站或其它一些网站上下载。现假设我们已经有了Fedora Core   2的安装盘，下面我们先大略看一下Fedora Core 2的安装盘里面的内容。</p>

<p>在安装盘中有一个目录为Fedora,它包含了发布盘的核心内容，如下：</p>

<pre><code>&lt;br&gt;&lt;/br&gt;drwxr-xr-x    2 root     root         2048 May 13 2004 base&lt;br&gt;&lt;/br&gt;drwxr-xr-x    2 root     root        77824 May 13 2004 RPMS&lt;br&gt;&lt;/br&gt;   
</code></pre>

<p>RPMS目录包含Fedora Core   2发布盘的主要部分，它是一些RPM文件。RPM包通常包含二进制可执行文件、有关的配置文件和文档，我们可以参考RPM帮助以获得更多信息。</p>

<p>base 目录中包含一些在安装过程中所需要的文件，如comps.xml文件，它定义哪个组件包含哪些RPM包以及RPM包之间的依赖关系，需要注意的是，在   comps.xml文件中表示哪个组件有哪些RPM包采用的是RPM包名，而不是包的文件名。比如perl-5.8.3-18.i386.rpm这个文件名，在comps.xml中所表示的RPM包名为perl。对于comps.xml文件，我们会在后面作进一步解释。另一个重要的文件是hdlist文件，它包含了RPM目录中的所有RPM包大部分的头文件，这意味着在RPM包中相互依赖关系可以通过读取hdlist文件而决定，而不需要读所有的RPM   包。hdlist文件的另一个作用是将包名映射到文件名，如将perl包名映射到perl-5.8.3-18.i386.rpm，这意味着如果你想更新   RPM包或添加你自己的包到RPM目录中，你就需要更新hdlist这个文件，这会在后面进行描述。</p>

<p>2 RPM操作</p>

<pre><code>       RPM （Redhat Package   Management）是由RedHat开发的，在Linux系统下的系统包管理工具。它的目标是：使包的安装和卸载过程更容易，它能够证实一个包是否已经正确安装了，可以简化包的建立过程，可以从源代码建立整个包，它能用于不同的体系结构。RPM系统已经成为现在Linux系统下包管理工具事实上的标准，并且它也移植到很多商业的unix系统之下。
</code></pre>

<p>RPM包由包标签对它标识，包标签包含软件名，软件版本，包的发行版本几部分。在包的内部还包含包的建立时间，包的内容描述，安装包的所有文件的大小，数字签名以证实包的完整性等信息。RMP包还包含包内的文件信息，其中包括：每个文件的文件名，每个文件的权限，文件的属组和拥有者，每个文件的md5校验和，文件的内容等。</p>

<p>RPM包管理系统提供了下列功能：安装新的包，卸载旧的包，将一个旧包升级为新的包，获得已经安装包的信息等。</p>

<p>Red Hat发布盘主要是由一些RPM包组成。RPM包的名字包含一个后缀：arch.rpm，arch   指的是体系结构，对于Intel平台的有i386、i586、i686等，你所安装的包必须要与机器上的共享库的版本相匹配。如果你发现某个RPM包没有安装，你可以自己安装。任何时候，你都可以（必须是root用户）安装RPM包。RPM命令使用轻参考相关资料。</p>

<p>3 RPM包创建过程</p>

<pre><code>       为了完成RPM包的创建，需要执行以下步骤：
</code></pre>

<ul>
<li><p>执行spec文件prep节的命令和宏；</p></li>
<li><p>检查文件列表的内容；</p></li>
<li><p>执行spec文件build节的命令和宏；</p></li>
<li><p>执行spec文件install节的命令和宏，同时也执行文件列表中的宏；</p></li>
<li><p>创建二进制包文件；</p></li>
<li><p>创建源码包。</p></li>
</ul>


<p>为了执行打包的工作，RPM需要一系列目录完成建立的工作。正常的目录结构通常由一个顶级目录和五个子目录构成。这五个子目录分别是：</p>

<ol>
<li><p> SOURCES&mdash;&mdash;&mdash;包含原始的源文件和补丁文件。</p></li>
<li><p> SPECS&mdash;&mdash;&mdash;&mdash;包含控制RPM包建立过程的spec文件。</p></li>
<li><p> BUILD&mdash;&mdash;&mdash;&mdash;包含源码解包和软件建立的目录。</p></li>
<li><p> RPMS&mdash;&mdash;&mdash;&mdash;-包含建立过程创建的二进制包文件。</p></li>
<li><p> SRPMS&mdash;&mdash;&mdash;&mdash;包含建立过程创建的源码包文件。</p></li>
</ol>


<p>除了上述这五个主要的目录外，在RPMS或SRPMS目录下通常还会有关于RPM包目标平台的目录。例如，i386、i586、i686等代表与Intel兼容cpu的平台，noarch目录下的RPM包代表可以在任何平台下执行。</p>

<pre><code>       spec文件是整个RPM包建立过程的中心，它的作用就如同编译程序时的Makefile文件。spec文件包含建立一个RPM包必需的信息，包括哪些文件是包的一部分以及它们安装在哪个目录下。这个文件一般分为如下的几节：
</code></pre>

<p>(1) Preamle（序言）</p>

<p>序言包含用户请求包的信息时所显示的内容。它可以包含包的功能描述、包的软件版本、版权信息和所属的包组等。Summary 是一行关于该软件包的描述，Name   是该软件包的基名，Version 是该软件的版本号，Release 是 RPM 本身的版本号，如果修复了 spec 文件中的一个错误并发布了该软件同一版本的新   RPM，就应该增加发行版号。License 应该给出一些许可术语（如：&#8221;GPL&#8221;、&#8221;Commercial&#8221;、&#8221;Shareware&#8221;），Group   标识软件类型。那些试图帮助人们管理 RPM 的程</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Your Name</span></span>

      








  


<time datetime="2005-04-07T20:28:35+08:00" pubdate data-updated="true">Apr 7<span>th</span>, 2005</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/linux-linux/'>linux[Linux]</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://yoursite.com/old_post.before.2007/2005-04-07-linux.html" data-via="" data-counturl="http://yoursite.com/old_post.before.2007/2005-04-07-linux.html" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/01/01/2013-summary-and-2014-outlook/">2013年终总结及2014年新年目标</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/09/09/tour-of-qingdao-b/">青岛两日游（中）</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/09/09/tour-of-qingdao-a/">青岛两日游（上）</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/07/06/outing-jiming-dak-in-hebei/">探访鸡鸣驿</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/06/13/pic-of-dsic/">一张流：大连造船厂</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Your Name -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
